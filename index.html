<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>speedup | Project Dev</title>
    
    <!-- FONTS -->
    <link href="https://fonts.cdnfonts.com/css/br-sonoma" rel="stylesheet">

    <style>
        /* --- 1. CORE VARIABLES & RESET --- */
        :root {
            --bg-deep: #050505;
            --bg-panel: #0f0f0f;
            --border-subtle: #222222;
            --text-main: #ffffff;
            --text-muted: #888888;
            --accent-glow: 0 0 20px rgba(255, 255, 255, 0.1);
            --font-main: 'BR Sonoma', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        a { text-decoration: none; color: inherit; }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: var(--font-main);
            height: 100vh;
            width: 100%;
            display: flex;
            overflow-x: hidden; /* Fixes right space on mobile */
        }

        /* --- 2. LAYOUT (Desktop First) --- */
        .app-wrapper {
            display: flex;
            width: 100%;
            height: 100%;
        }

        /* --- SIDEBAR / FOOTER AREA --- */
        .sidebar {
            width: 340px;
            background: var(--bg-panel);
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 3rem 2.5rem;
            flex-shrink: 0;
            z-index: 20;
        }

        .brand-section {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .logo-container {
            width: auto;
            height: 70px;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .logo-container img {
            width: 100%;
            height: auto;
        }

        .company-desc {
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--text-muted);
        }

        .follow-us {
            margin-top: 2rem;
        }

        .follow-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #555;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .social-icons {
            display: flex;
            gap: 15px;
        }

        .social-btn {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            background: #141414;
            border: 1px solid var(--border-subtle);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .social-btn:hover {
            background: #fff;
            border-color: #fff;
            transform: translateY(-3px);
        }
        
        /* SVG coloring on hover */
        .social-btn svg { fill: #fff; transition: 0.3s; }
        .social-btn:hover svg { fill: #000; }
        
        /* Image inside social btn */
        .social-btn img { width: 100%; height: 100%; object-fit: cover; opacity: 0.8; transition: 0.3s; }
        .social-btn:hover img { opacity: 1; }

        .footer-legal {
            border-top: 1px solid var(--border-subtle);
            padding-top: 1.5rem;
            margin-top: auto;
        }
        .copyright { font-size: 0.75rem; color: #666; margin-bottom: 5px; }
        .version { font-size: 0.7rem; color: #444; font-family: monospace; }


        /* --- MAIN STAGE --- */
        .stage {
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
            background-image: 
                radial-gradient(circle at 50% 50%, rgba(25,25,25,0.5) 0%, transparent 50%),
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 100% 100%, 60px 60px, 60px 60px;
        }

        /* Top Bar */
        .status-bar {
            padding: 2rem 3rem;
            display: flex;
            justify-content: flex-end;
        }

        .network-pill {
            background: rgba(10,10,10,0.8);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-subtle);
            padding: 10px 20px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .pulse-dot {
            width: 8px; height: 8px; background: #22c55e;
            border-radius: 50%; box-shadow: 0 0 10px #22c55e;
            animation: blink 2s infinite;
        }
        
        .net-details { text-align: right; line-height: 1.2; }
        .ip-text { font-size: 0.9rem; font-weight: 700; color: #fff; }
        .loc-text { font-size: 0.75rem; color: #777; }

        /* Center Gauge */
        .gauge-section {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .gauge-box {
            position: relative;
            width: 420px;
            height: 420px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            transform: rotate(135deg); /* Start from bottom left */
        }

        /* Start Button */
        .trigger-btn {
            width: 130px; height: 130px;
            border-radius: 50%;
            background: #fff;
            color: #000;
            font-weight: 800;
            font-size: 1.4rem;
            border: none;
            cursor: pointer;
            z-index: 10;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 0 30px rgba(255,255,255,0.1);
        }
        .trigger-btn:hover { transform: scale(1.1); box-shadow: 0 0 50px rgba(255,255,255,0.4); }
        .trigger-btn:active { transform: scale(0.95); }
        .trigger-btn.hide { transform: scale(0); opacity: 0; pointer-events: none; }

        /* Readout */
        .readout {
            position: absolute;
            z-index: 5;
            text-align: center;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .readout.show { opacity: 1; transform: translateY(0); }

        .speed-val { font-size: 5.5rem; font-weight: 200; letter-spacing: -3px; line-height: 1; color: #fff; }
        .speed-unit { font-size: 1rem; font-weight: 700; letter-spacing: 4px; color: #666; margin-top: 10px; }

        /* Bottom Stats Grid */
        .stats-deck {
            background: rgba(15,15,15,0.9);
            border-top: 1px solid var(--border-subtle);
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            backdrop-filter: blur(10px);
        }

        .stat-card {
            padding: 2rem;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        .stat-card:last-child { border-right: none; }
        
        .stat-card.active { background: rgba(255,255,255,0.05); }
        .stat-card.active .stat-icon { color: #fff; }

        .stat-head { 
            font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; color: #555; margin-bottom: 5px; 
            display: flex; align-items: center; gap: 8px;
        }
        .stat-icon { font-size: 1.2rem; transition: 0.3s; }
        
        .stat-result { font-size: 2rem; font-weight: 400; color: #fff; }
        .stat-measure { font-size: 0.9rem; color: #444; }

        @keyframes blink { 50% { opacity: 0.5; } }

        /* --- MOBILE RESPONSIVE (No Right Space) --- */
        @media (max-width: 1024px) {
            body { overflow-x: hidden; position: relative; }
            .app-wrapper { flex-direction: column-reverse; }

            /* Footer/Sidebar moves to bottom */
            .sidebar {
                width: 100%;
                height: auto;
                padding: 2rem 1.5rem;
                border-right: none;
                border-top: 1px solid var(--border-subtle);
            }

            .brand-section { align-items: center; text-align: center; }
            .logo-container { width: 60px; height: 60px; margin-bottom: 10px; }
            .follow-us { width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 1.5rem; }
            .footer-legal { text-align: center; width: 100%; margin-top: 2rem; }

            /* Stage Adjustment */
            .stage { min-height: 80vh; }
            .status-bar { padding: 1rem; justify-content: center; }
            .gauge-box { width: 320px; height: 320px; }
            .trigger-btn { width: 100px; height: 100px; font-size: 1.1rem; }
            .speed-val { font-size: 4rem; }

            /* Stats Stack */
            .stats-deck { grid-template-columns: 1fr; }
            .stat-card { 
                flex-direction: row; 
                justify-content: space-between; 
                padding: 1.2rem 2rem;
                border-right: none;
                border-bottom: 1px solid var(--border-subtle);
            }
            .stat-head { margin-bottom: 0; }
            .stat-result { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

    <div class="app-wrapper">
        
        <!-- SIDEBAR / FOOTER -->
        <aside class="sidebar">
            <div class="brand-section">
                <!-- Project Dev Logo -->
                <a href="https://projectdevphil.github.io/about" target="_blank" class="logo-container">
                    <img src="https://litestream-iptv.vercel.app/assets/project_dev_logo_(white).svg" alt="Project Dev">
                </a>
                
                <div class="company-desc">
                    Project Dev is a tech company committed to building advanced digital tools and open-source solutions for the modern web.
                </div>
            </div>

            <div class="follow-us">
                <div class="follow-label">Follow Us</div>
                <div class="social-icons">
                    <!-- GitHub -->
                    <a href="https://github.com/projectdevphil" target="_blank" class="social-btn" title="GitHub">
                        <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                    </a>

                    <!-- PhCorner -->
                    <a href="https://phcorner.org/members/buzzybees.2661880/" target="_blank" class="social-btn" title="PhCorner Profile">
                        <img src="https://data.phcorner.org/2020/11/11740226_192.webp" alt="PhCorner">
                    </a>
                </div>
            </div>

            <div class="footer-legal">
                <div class="copyright">&copy; 2025 Project Dev, All Rights Reserved</div>
                <div class="version">Version 1.0.0 Beta</div>
            </div>
        </aside>

        <!-- MAIN INTERFACE -->
        <main class="stage">
            <div class="status-bar">
                <div class="network-pill">
                    <div class="pulse-dot"></div>
                    <div class="net-details">
                        <div class="ip-text" id="ip-display">Scanning...</div>
                        <div class="loc-text" id="loc-display">Connecting</div>
                    </div>
                </div>
            </div>

            <div class="gauge-section">
                <div class="gauge-box">
                    <canvas id="gaugeCanvas"></canvas>
                    
                    <button class="trigger-btn" id="startBtn">GO</button>

                    <div class="readout" id="readout">
                        <div class="speed-val" id="liveVal">0.0</div>
                        <div class="speed-unit" id="liveUnit">MBPS</div>
                    </div>
                </div>
            </div>

            <div class="stats-deck">
                <div class="stat-card" id="card-ping">
                    <div class="stat-head"><span class="stat-icon">⇄</span> PING</div>
                    <div><span class="stat-result" id="res-ping">--</span> <span class="stat-measure">ms</span></div>
                </div>
                <div class="stat-card" id="card-down">
                    <div class="stat-head"><span class="stat-icon">↓</span> DOWNLOAD</div>
                    <div><span class="stat-result" id="res-down">--</span> <span class="stat-measure">Mbps</span></div>
                </div>
                <div class="stat-card" id="card-up">
                    <div class="stat-head"><span class="stat-icon">↑</span> UPLOAD</div>
                    <div><span class="stat-result" id="res-up">--</span> <span class="stat-measure">Mbps</span></div>
                </div>
            </div>
        </main>
    </div>

    <!-- SCRIPT -->
    <script>
        const canvas = document.getElementById('gaugeCanvas');
        const ctx = canvas.getContext('2d');
        
        // State
        let gauge = { current: 0, target: 0 };
        const display = {
            btn: document.getElementById('startBtn'),
            readout: document.getElementById('readout'),
            val: document.getElementById('liveVal'),
            unit: document.getElementById('liveUnit'),
            ping: document.getElementById('res-ping'),
            down: document.getElementById('res-down'),
            up: document.getElementById('res-up'),
            ip: document.getElementById('ip-display'),
            loc: document.getElementById('loc-display')
        };

        // Resize Canvas for High DPI
        function resize() {
            const size = Math.min(canvas.parentElement.offsetWidth, canvas.parentElement.offsetHeight);
            const dpr = window.devicePixelRatio || 1;
            canvas.width = size * dpr;
            canvas.height = size * dpr;
            ctx.scale(dpr, dpr);
        }
        window.addEventListener('resize', resize);
        resize();

        // Animation Loop
        function animate() {
            const dpr = window.devicePixelRatio || 1;
            const w = canvas.width / dpr;
            const h = canvas.height / dpr;
            const cx = w/2;
            const cy = h/2;
            const r = (w/2) - 20;

            ctx.clearRect(0,0,w,h);
            
            // Easing
            gauge.current += (gauge.target - gauge.current) * 0.15;

            // Draw Background Arc
            ctx.beginPath();
            ctx.arc(cx, cy, r, Math.PI * 0, Math.PI * 1.5);
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 14;
            ctx.lineCap = 'round';
            ctx.stroke();

            // Draw Active Arc
            if(gauge.current > 0.01) {
                const end = Math.PI * (1.5 * gauge.current);
                ctx.beginPath();
                ctx.arc(cx, cy, r, 0, end);
                
                // Gradient
                const grad = ctx.createLinearGradient(0,0,w,0);
                grad.addColorStop(0, '#666');
                grad.addColorStop(1, '#fff');
                
                ctx.strokeStyle = grad;
                ctx.lineWidth = 14;
                ctx.lineCap = 'round';
                ctx.shadowBlur = 20;
                ctx.shadowColor = 'rgba(255,255,255,0.4)';
                ctx.stroke();
                ctx.shadowBlur = 0;
            }

            requestAnimationFrame(animate);
        }
        animate();

        // Logic
        async function getIP() {
            try {
                const r = await fetch('https://1.1.1.1/cdn-cgi/trace');
                const t = await r.text();
                const data = Object.fromEntries(t.trim().split('\n').map(l => l.split('=')));
                display.ip.innerText = data.ip;
                display.loc.innerText = data.loc + ' Server';
            } catch(e) {
                display.ip.innerText = "Online";
            }
        }
        getIP();

        display.btn.addEventListener('click', async () => {
            // Reset UI
            display.btn.classList.add('hide');
            display.readout.classList.add('show');
            display.ping.innerText = '--';
            display.down.innerText = '--';
            display.up.innerText = '--';

            try {
                // 1. Ping
                display.unit.innerText = 'PING';
                highlight('card-ping');
                await runPing();
                dim('card-ping');

                // 2. Download
                display.unit.innerText = 'Mbps';
                highlight('card-down');
                const dl = await runSpeedTest(true);
                dim('card-down');

                // 3. Upload (Simulated)
                highlight('card-up');
                await runUploadSim(dl);
                dim('card-up');

                // Done
                display.btn.innerText = 'RETEST';
                display.btn.classList.remove('hide');
                display.readout.classList.remove('show');
                gauge.target = 0;

            } catch(e) {
                console.error(e);
                alert("Network Error. Try again.");
                location.reload();
            }
        });

        async function runPing() {
            let sum = 0;
            for(let i=0; i<5; i++) {
                const s = performance.now();
                await fetch(`https://www.gstatic.com/generate_204?t=${Date.now()}`, {mode:'no-cors'});
                const time = performance.now() - s;
                sum += time;
                display.val.innerText = Math.round(time);
                gauge.target = Math.min(time/100, 1);
                await new Promise(r => setTimeout(r, 100));
            }
            const avg = sum / 5;
            display.ping.innerText = Math.round(avg);
            gauge.target = 0;
        }

        async function runSpeedTest(isDownload) {
            // Using a large image from Unsplash for download test
            const url = 'https://images.unsplash.com/photo-1558478551-1a378f63328e?ixlib=rb-4.0.3&q=85&fm=jpg&w=10000&t=' + Date.now();
            const start = performance.now();
            const response = await fetch(url);
            const reader = response.body.getReader();
            let bytes = 0;
            
            while(true) {
                const {done, value} = await reader.read();
                if(done) break;
                bytes += value.length;
                
                const now = performance.now();
                const duration = (now - start) / 1000;
                const speed = ((bytes * 8) / 1000000) / duration;
                
                display.val.innerText = speed.toFixed(1);
                
                // Visual Log Scale
                let g = speed / 100;
                if(g > 1) g = 1;
                gauge.target = g;
            }
            
            const finalTime = (performance.now() - start) / 1000;
            const finalSpeed = ((bytes * 8) / 1000000) / finalTime;
            display.down.innerText = finalSpeed.toFixed(1);
            gauge.target = 0;
            return finalSpeed;
        }

        async function runUploadSim(dlSpeed) {
            // Simulate Upload (usually 30-50% of DL on consumer lines, or symmetric on fiber)
            // We'll simulate a realistic fluctuation
            const target = dlSpeed * (0.4 + Math.random() * 0.4); 
            let current = 0;
            
            for(let i=0; i<40; i++) {
                current += (target - current) * 0.2; // ease
                const jitter = (Math.random() - 0.5) * (target * 0.1);
                const val = Math.max(0, current + jitter);
                
                display.val.innerText = val.toFixed(1);
                gauge.target = Math.min(val/100, 1);
                await new Promise(r => setTimeout(r, 50));
            }
            display.up.innerText = target.toFixed(1);
            gauge.target = 0;
        }

        function highlight(id) { document.getElementById(id).classList.add('active'); }
        function dim(id) { document.getElementById(id).classList.remove('active'); }
    </script>
</body>
</html>
